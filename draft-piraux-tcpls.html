<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>TCPLS: Modern Transport Services with TCP and TLS</title>
<meta content="Maxime Piraux" name="author">
<meta content="Florentin Rochet" name="author">
<meta content="Olivier Bonaventure" name="author">
<meta content="
       This document specifies a protocol leveraging TCP and TLS to provide modern
transport services such as multiplexing, connection migration and multipath
in a secure manner. 
    " name="description">
<meta content="xml2rfc 3.17.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-piraux-tcpls-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.17.0
    Python 3.10.10
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.1
    setuptools 65.6.0
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-piraux-tcpls.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">TCPLS</td>
<td class="right">April 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Piraux, et al.</td>
<td class="center">Expires 9 October 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-piraux-tcpls-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-04-07" class="published">7 April 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-10-09">9 October 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Piraux</div>
<div class="org">UCLouvain</div>
</div>
<div class="author">
      <div class="author-name">F. Rochet</div>
<div class="org">University of Namur</div>
</div>
<div class="author">
      <div class="author-name">O. Bonaventure</div>
<div class="org">UCLouvain</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">TCPLS: Modern Transport Services with TCP and TLS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a protocol leveraging TCP and TLS to provide modern
transport services such as multiplexing, connection migration and multipath
in a secure manner.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/mpiraux/draft-piraux-tcpls">https://github.com/mpiraux/draft-piraux-tcpls</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 9 October 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-notational-conventions" class="internal xref">Notational conventions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-modern-transport-services" class="internal xref">Modern Transport Services</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-tcpls-overview" class="internal xref">TCPLS Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-multiple-streams" class="internal xref">Multiple Streams</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-multiple-tcp-connections" class="internal xref">Multiple TCP connections</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-joining-tcp-connections" class="internal xref">Joining TCP connections</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-robust-session-establishmen" class="internal xref">Robust session establishment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-failover" class="internal xref">Failover</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="auto internal xref">4.2.4</a>.  <a href="#name-migration" class="internal xref">Migration</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5">
                    <p id="section-toc.1-1.4.2.2.2.5.1"><a href="#section-4.2.5" class="auto internal xref">4.2.5</a>.  <a href="#name-multipath" class="internal xref">Multipath</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-record-protection" class="internal xref">Record protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-closing-a-tcpls-session" class="internal xref">Closing a TCPLS session</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-zero-copy-receive-path" class="internal xref">Zero-Copy Receive Path</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-tcpls-protocol" class="internal xref">TCPLS Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-tcpls-tls-extensions" class="internal xref">TCPLS TLS Extensions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-tcpls" class="internal xref">TCPLS</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-tcpls-join" class="internal xref">TCPLS Join</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-tcpls-token" class="internal xref">TCPLS Token</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-tcpls-frames" class="internal xref">TCPLS Frames</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-padding-frame" class="internal xref">Padding frame</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-ping-frame" class="internal xref">Ping frame</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-stream-frame" class="internal xref">Stream frame</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="auto internal xref">5.2.4</a>.  <a href="#name-ack-frame" class="internal xref">ACK frame</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a href="#section-5.2.5" class="auto internal xref">5.2.5</a>.  <a href="#name-new-token-frame" class="internal xref">New Token frame</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.6">
                    <p id="section-toc.1-1.5.2.2.2.6.1"><a href="#section-5.2.6" class="auto internal xref">5.2.6</a>.  <a href="#name-connection-reset-frame" class="internal xref">Connection Reset frame</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.7">
                    <p id="section-toc.1-1.5.2.2.2.7.1"><a href="#section-5.2.7" class="auto internal xref">5.2.7</a>.  <a href="#name-new-address-frame" class="internal xref">New Address frame</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.8">
                    <p id="section-toc.1-1.5.2.2.2.8.1"><a href="#section-5.2.8" class="auto internal xref">5.2.8</a>.  <a href="#name-remove-address-frame" class="internal xref">Remove Address frame</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.9">
                    <p id="section-toc.1-1.5.2.2.2.9.1"><a href="#section-5.2.9" class="auto internal xref">5.2.9</a>.  <a href="#name-stream-change-frame" class="internal xref">Stream Change frame</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-tcpls-tls-extensions-2" class="internal xref">TCPLS TLS Extensions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-tcpls-frames-3" class="internal xref">TCPLS Frames</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-alternative-designs" class="internal xref">Alternative Designs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-securing-new-tcp-connection" class="internal xref">Securing new TCP connections with New Session Tickets</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-change-log" class="internal xref">Change log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-C.1" class="auto internal xref"></a><a href="#name-since-draft-piraux-tcpls-02" class="internal xref">Since draft-piraux-tcpls-02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-C.2" class="auto internal xref"></a><a href="#name-since-draft-piraux-tcpls-01" class="internal xref">Since draft-piraux-tcpls-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-C.3" class="auto internal xref"></a><a href="#name-since-draft-piraux-tcpls-00" class="internal xref">Since draft-piraux-tcpls-00</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The TCP/IP protocol stack continuously evolves. In the early days, most
applications were interacting with the transport layer (mainly TCP, but
also UDP) using the socket API. This is illustrated in <a href="#fig-intro-old" class="auto internal xref">Figure 1</a>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<span id="name-the-classical-tcp-ip-protoc"></span><div id="fig-intro-old">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-1-2.1">
<pre>
+------------------------------+
|          Application         |
+------------------------------+
|            TCP/UDP           |
+------------------------------+
|             IPv4             |
+------------------------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-the-classical-tcp-ip-protoc" class="selfRef">The classical TCP/IP protocol stack</a>
        </figcaption></figure>
</div>
<p id="section-1-3">The TCP/IP stack has slowly evolved and the figure above does not
anymore describe current Internet applications. IPv6 is now widely
deployed next to IPv4 in the network layer. In the transport layer,
protocols such as SCTP <span>[<a href="#RFC4960" class="cite xref">RFC4960</a>]</span> or DCCP <span>[<a href="#RFC6335" class="cite xref">RFC6335</a>]</span> and TCP
extensions including Multipath TCP <span>[<a href="#RFC8684" class="cite xref">RFC8684</a>]</span> or tcpcrypt <span>[<a href="#RFC8548" class="cite xref">RFC8548</a>]</span>
have been specified. The security aspects of the TCP/IP protocol suite
are much more important today than in the past <span>[<a href="#RFC7258" class="cite xref">RFC7258</a>]</span>. Many
applications rely on TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> and their stack is
similar to the one shown in <a href="#fig-intro-today" class="auto internal xref">Figure 2</a>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<span id="name-todays-tcp-ip-protocol-stac"></span><div id="fig-intro-today">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-1-4.1">
<pre>
+------------------------------+
|          Application         |
+------------------------------+
|             TLS              |
+------------------------------+
|             TCP              |
+------------------------------+
|          IPv4/IPv6           |
+------------------------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-todays-tcp-ip-protocol-stac" class="selfRef">Today's TCP/IP protocol stack</a>
        </figcaption></figure>
</div>
<p id="section-1-5">Recently, the IETF went one step further in improving the transport
layer with the QUIC protocol <span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>. QUIC is a new secure transport
protocol primarily designed for HTTP/3. It includes the reliability and
congestion control features that are part of TCP and integrates the
security features of TLS 1.3 <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>. This close integration between
the reliability and security features brings a lot of benefits in QUIC.
QUIC runs above UDP to be able to pass through most middleboxes and to be
implementable in user space. While QUIC reuses TLS, it does not strictly layer
TLS on top of UDP as DTLS <span>[<a href="#I-D.ietf-tls-dtls13" class="cite xref">I-D.ietf-tls-dtls13</a>]</span>. This organization,
illustrated in <a href="#fig-intro-quic" class="auto internal xref">Figure 3</a> provides much more flexibility than simply
layering TLS above UDP. For example, the QUIC migration capabilities enable
an application to migrate an existing QUIC session from an IPv4 path to an
IPv6 one.<a href="#section-1-5" class="pilcrow">¶</a></p>
<span id="name-quic-protocol-stack"></span><div id="fig-intro-quic">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-1-6.1">
<pre>
+------------------------------+
|          Application         |
+------------------------------+
|..........                    |
|   TLS   |   QUIC   ..........|
|..........          |   UDP   |
+------------------------------+
|          IPv4/IPv6           |
+------------------------------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-quic-protocol-stack" class="selfRef">QUIC protocol stack</a>
        </figcaption></figure>
</div>
<p id="section-1-7">In this document, we revisit how TCP and TLS 1.3 can be used to
provide modern transport services to applications. We apply a similar principle
and combine TCP and TLS 1.3 in a protocol that we call TCPLS.
TCPLS leverages the security features of TLS 1.3 like QUIC, but without
begin simply layered above a single TCP connection. In addition,
TCPLS reuses the existing TCP stacks and TCP's wider support in current
networks. A preliminary version of the TCPLS protocol is described in <span>[<a href="#CONEXT21" class="cite xref">CONEXT21</a>]</span>.<a href="#section-1-7" class="pilcrow">¶</a></p>
<span id="name-tcpls-in-the-tcp-ip-protoco"></span><div id="fig-intro-tcpls">
<figure id="figure-4">
        <div class="alignLeft art-text artwork" id="section-1-8.1">
<pre>
+------------------------------+
|          Application         |
+------------------------------+
|..........                    |
|   TLS   |   TCPLS  ..........|
|..........          |   TCP   |
+------------------------------+
|          IPv4/IPv6           |
+------------------------------+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-tcpls-in-the-tcp-ip-protoco" class="selfRef">TCPLS in the TCP/IP protocol stack</a>
        </figcaption></figure>
</div>
<p id="section-1-9">In this document, we use the term TLS/TCP to refer to the TLS 1.3
protocol running over one TCP connection. We reserve the word TCPLS for
the protocol proposed in this document.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">This document is organized as follows. First, <a href="#services" class="auto internal xref">Section 3</a> summarizes the
different types of services that modern transports expose to application.
<a href="#overview" class="auto internal xref">Section 4</a> gives an overview of TCPLS and how it supports these
services. Finally, <a href="#format" class="auto internal xref">Section 5</a> describes the TCPLS in more details
and the TLS Extensions introduced in this document.<a href="#section-1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="notational-conventions">
<section id="section-2.1">
        <h3 id="name-notational-conventions">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational conventions</a>
        </h3>
<p id="section-2.1-1">This document uses the same conventions as defined in Section 1.3 of
<span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">This document uses network byte order (that is, big endian) values.
Fields are placed starting from the high-order bits of each byte.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="services">
<section id="section-3">
      <h2 id="name-modern-transport-services">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-modern-transport-services" class="section-name selfRef">Modern Transport Services</a>
      </h2>
<p id="section-3-1">Application requirements and the devices they run on evolve over time. In
the early days, most applications involved single-file transfer and ran on
single-homed computers with a fixed-line network. Today, web-based applications
require exchanging multiple objects, with different priorities, on
devices that can move from one access network to another and that often
have multiple access networks available. Security is also a key requirement
of applications that evolved from only guaranteeing the confidentiality and
integrity of application messages to also preventing pervasive monitoring.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">With TCP and TLS/TCP, applications use a single connection that supports
a single bytestream in each direction.
Some TCP applications such as HTTP/2 <span>[<a href="#RFC7540" class="cite xref">RFC7540</a>]</span> use multiple
streams, but these are mapped to a single TCP connection which leads
to Head-of-Line (HoL) blocking when packet losses occur. SCTP <span>[<a href="#RFC4960" class="cite xref">RFC4960</a>]</span>
supports multiple truly-concurrent streams and QUIC adopted a similar
approach to prevent HoL blocking.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Modern transport services also changed the utilization of the underlying network.
With TCP, when a host creates a connection, it is bound to the
IP addresses used by the client and the server during the handshake. When the
client moves and receives a different IP address, it has to reestablish all TCP
connections bound to the previous address.
When the client and the server are dual-stack, they cannot easily switch from
one address family to another. Happy Eyeballs <span>[<a href="#RFC8305" class="cite xref">RFC8305</a>]</span> provides a partial
answer to this problem for web applications with heuristics that clients can
use to probe TCP connections with different address families.
With Multipath TCP, the client and the
server can learn other addresses of the remote host and combine several
TCP connections within a single Multipath TCP connection that is exposed to
the application. This supports various use cases <span>[<a href="#RFC8041" class="cite xref">RFC8041</a>]</span>. QUIC <span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>
enables applications to migrate from one network path to another, but not
to simultaneously use different paths.<a href="#section-3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-4">
      <h2 id="name-tcpls-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-tcpls-overview" class="section-name selfRef">TCPLS Overview</a>
      </h2>
<p id="section-4-1">In order for TCPLS to be widely compatible with middleboxes that inspect TCP
segments and TLS records, TCPLS does not modify the TCP connection establishment
and only adds a TLS extension to the TLS handshake. <a href="#fig-overview-handshake" class="auto internal xref">Figure 5</a>
illustrates the opening of a TCPLS session which starts with the TCP
3-way handshake, followed by the TLS handshake. In
the Extensions of the ClientHello and in the server EncryptedExtensions, the
tcpls TLS Extension is introduced to announce the support of TCPLS.<a href="#section-4-1" class="pilcrow">¶</a></p>
<span id="name-starting-a-tcpls-session"></span><div id="fig-overview-handshake">
<figure id="figure-5">
        <div class="alignLeft art-text artwork" id="section-4-2.1">
<pre>
Client                                   Server
 |                    SYN                    |
 |------------------------------------------&gt;|
 |                  SYN+ACK                  |
 |&lt;------------------------------------------|
 |       ACK, TLS ClientHello + tcpls        |
 |------------------------------------------&gt;|
 |  TLS ServerHello, TLS EncryptedExtensions |
 |                          + tcpls, ...     |
 |&lt;------------------------------------------|
 |               TLS Finished                |
 |------------------------------------------&gt;|
 |                                           |
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-starting-a-tcpls-session" class="selfRef">Starting a TCPLS session</a>
        </figcaption></figure>
</div>
<p id="section-4-3">TCP/TLS offers a single encrypted bytestream service to the application.
To achieve this, TLS records are used to encrypt and secure chunks of
the application bytestream and are then sent through the TCP bytestream.
TCPLS leverages TLS records differently. TCPLS defines its own framing
that allows encoding application data and control information. A TCPLS frame
is the basic unit of information for TCPLS. A TCPLS frame always fits in a
single record. One or more TCPLS frames can be encoded in a TLS record.
This TLS record is then reliably transported by a TCP connection.
<a href="#fig-tcpls-frames" class="auto internal xref">Figure 6</a> illustrates the relationship between
TCPLS frames and TLS records.<a href="#section-4-3" class="pilcrow">¶</a></p>
<span id="name-the-first-tls-record-contai"></span><div id="fig-tcpls-frames">
<figure id="figure-6">
        <div class="alignLeft art-text artwork" id="section-4-4.1">
<pre>
  TCPLS Data     TCP Control      TCPLS Data
  abcdef         0010010          mnopq...
  &lt;---------&gt;   &lt;-----------&gt;    &lt;------------&gt;
 /                          /
/                          /
|                         /
|                        /
|                      /
|                    /
|                  /
|                 /
+----------------+     +-----------------+
|   TLS record n |     | TLS record n+1  |  ....
+----------------+     +-----------------+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-the-first-tls-record-contai" class="selfRef">The first TLS record contains two TCPLS frames</a>
        </figcaption></figure>
</div>
<div id="multiple-streams">
<section id="section-4.1">
        <h3 id="name-multiple-streams">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-multiple-streams" class="section-name selfRef">Multiple Streams</a>
        </h3>
<p id="section-4.1-1">TCPLS extends the service provided by TCP with streams. Streams are
independent bidirectional bytestreams that can be used by applications to
concurrently convey several objects over a TCPLS session.
Streams can be opened by the client and by the server.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Streams are identified by a 32-bit unsigned integer. The parity of this number
indicates the initiator of the stream. The client opens even-numbered
streams while the server opens odd-numbered streams. Streams are opened in
sequence, e.g. a client that has opened stream 0 will use stream 2 as the
next one.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Data is exchanged using Stream frames whose format is
described in <a href="#stream-frame" class="auto internal xref">Section 5.2.3</a>. Each Stream frame carries a chunk of data of
a given stream. Applications can mark the end of a stream to close it.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">TCPLS enables the receiver to decrypt and process TLS records in
zero copy similarly to TLS 1.3 under circumstances discussed in
<a href="#zero-copy-receive-path" class="auto internal xref">Section 4.5</a>.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">Similarly to HTTP/2 <span>[<a href="#RFC7540" class="cite xref">RFC7540</a>]</span>, conveying several streams on a single TCP
connection introduces Head-of-Line (HoL) blocking between the streams. To
alleviate this, TCPLS provides means to the application to choose the degree
of HoL blocking resilience it needs for its application objects by spreading
streams among different underlying TCP connections.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-tcp-connections">
<section id="section-4.2">
        <h3 id="name-multiple-tcp-connections">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-multiple-tcp-connections" class="section-name selfRef">Multiple TCP connections</a>
        </h3>
<p id="section-4.2-1">TCPLS is not restricted to using a single TCP connection to exchange frames.
A TCPLS session starts with the TCP connection that was used to transport the
TLS handshake. After this handshake, other TCP connections can be added
to a TCPLS session, either to spread the load or for failover. TCPLS manages
the utilization of the underlying TCP connections within a TCPLS session.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Multipath TCP enables both the client and the server to establish additional
TCP connections. However, experience has shown that additional subflows are only
established by the clients. TCPLS focuses on this deployment and only allows
clients to create additional TCP connections.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Using Multipath TCP, a client can try establishing a new TCP connection at
any time. If a server wishes to restrict the number of TCP connections that
correspond to one Multipath TCP connection, it has to respond with RST to
the in excess connection attempts.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">TCPLS takes another approach. To control the number of connections that a
client can establish, a TCPLS server supplies unique tokens. A client includes
one of the server supplied tokens when it attaches a new TCP connection to a
TCPLS session. Each token can only be used once, hence limiting the amount of
additional TCP connections.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">TCPLS endpoints can advertise their local addresses, allowing new TCP
connections for a given TCPLS session to be established between new pairs of
addresses. When an endpoint is no more willing new TCP connections to use one
of its advertised addresses, it can remove this address from the TCPLS session.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<div id="joining-tcp-connections">
<section id="section-4.2.1">
          <h4 id="name-joining-tcp-connections">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-joining-tcp-connections" class="section-name selfRef">Joining TCP connections</a>
          </h4>
<p id="section-4.2.1-1">The TCPLS server provides tokens to the client in order to join new TCP
connections to the TCPLS session. <a href="#join-connections" class="auto internal xref">Figure 7</a> illustrates a client
and server first establishing a new TCPLS session as described in <a href="#overview" class="auto internal xref">Section 4</a>.
Then the server sends a token over this connection using the New Token
frame. Each token has a sequence number (e.g. 1) and a value (e.g. "abc").
The client uses this token to open a new TCP connection and initiates the
TCPLS handshake. It adds the token inside the TCPLS Join TLS extension in the
ClientHello.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<span id="name-joining-a-new-tcp-connectio"></span><div id="join-connections">
<figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-4.2.1-2.1">
<pre>
              &lt;-1.TCPLS Handshake-&gt;
       .----------------------------------.
       |             &lt;-2.New Token(1,abc) |
       v                                  v
+--------+                             +--------+
| Client |                             | Server |
+--------+                             +--------+
       ^                                  ^
       | 3.TCPLS Hsh. + tcpls_join(abc)-&gt; |      Legend:
       .----------------------------------.        --- TCP connection
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-joining-a-new-tcp-connectio" class="selfRef">Joining a new TCP connection</a>
            </figcaption></figure>
</div>
<p id="section-4.2.1-3">When receiving a TCPLS Join Extension, the server validates the token and
associates the TCP connection to the TCPLS session.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4">Each TCP connection that is part of a TCPLS session is identified by a 32-bit
unsigned integer called its Connection ID. The first TCP connection of a session
corresponds to Connection ID 0. When joining a new connection,
the sequence number of the token, i.e. 1 in our example, becomes the
Connection ID of the connection. The Connection ID enables the Client and
the Server to identify a specific TCP connection within a given TCPLS
session.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="robust-session-establishment">
<section id="section-4.2.2">
          <h4 id="name-robust-session-establishmen">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-robust-session-establishmen" class="section-name selfRef">Robust session establishment</a>
          </h4>
<p id="section-4.2.2-1">The TCPLS protocol also supports robust session establishment, where a
multihomed or dual-stack client can establish a TCPLS session when at least
one network path to the server can be established. This guarantees robustness
against network failures and lowers the overall latency of a session
establishment.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2"><a href="#fig-robust-session-establishment" class="auto internal xref">Figure 8</a> illustrates a dual-homed client that
robustly establish a TCPLS session over two local addresses. In this example,
the path from IP b towards the server exhibits a higher delay.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<span id="name-robust-session-establishment"></span><div id="fig-robust-session-establishment">
<figure id="figure-8">
            <div class="alignLeft art-text artwork" id="section-4.2.2-3.1">
<pre>
Client @ IP a                 Server                 Client @ IP b
 |             SYN              |             SYN              |
 |-----------------------------&gt;|               /--------------|
 |           SYN+ACK            |&lt;-------------/               |
 |&lt;-----------------------------|           SYN+ACK            |
 | ACK, TLS CH + tcpls          |--------------\               |
 |-----------------------------&gt;|               \-------------&gt;|
 |      TLS SH, EE + tcpls,     |             ACK              |
 |        tcpls_token(abc), ... |&lt;-----------------------------|
 |&lt;-----------------------------|TLS CH + tcpls,tcpls_join(abc)|
 | TLS Finished                 |&lt;-----------------------------|
 |-----------------------------&gt;|                              |
 | TCPLS session established and 2nd connection can be joined. |
                               ...
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-robust-session-establishment" class="selfRef">Robust session establishment example</a>
            </figcaption></figure>
</div>
<p id="section-4.2.2-4">The client starts by opening a TCP connection on from each of its local
addresses. The TCP connection from IP "a" towards the server completes faster
than the other. The client then starts a TCPLS Handshake on
this connection. When the other connection is established, the client
waits for receiving a TCPLS token allowing to join it to the session being
established. In addition to the New Token frame, the TCPLS protocol enables
the server to provide one such token during the handshake using the TCPLS Token
TLS extension. The server uses this extension when sending its
EncryptedExtensions over the faster connection to provide the TCPLS token
"abc". As soon as the client has received this token, it uses
it over the other connection to join it to the session.
When the TLS handshake completes over the fastest connection, the TCPLS session
is established and the other connection can be joined to the session.<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="failover">
<section id="section-4.2.3">
          <h4 id="name-failover">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-failover" class="section-name selfRef">Failover</a>
          </h4>
<p id="section-4.2.3-1">TCPLS supports two types of failover. In make-before-break, the client
creates a TCP connection using the procedure described in
<a href="#joining-tcp-connections" class="auto internal xref">Section 4.2.1</a> but only uses it once the initial connection fails.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">In break-before-make, the
client creates the initial TCP connection and uses it for the TCPLS handshake
and the data. The server advertises one or more tokens over this connection.
Upon failure of the initial TCP connection, the client initiates a
second TCP connection using the server-provided token.<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
<p id="section-4.2.3-3">In both cases, some records sent by the client or the server might be
in transit when the failure occurs. Some of these records could have been
partially received but not yet delivered to the TCPLS layer when the
underlying TCP connection fails. Other records could have already been received,
decrypted and data of their frames could have been delivered to the
application. To prevent data losses and duplication, TCPLS includes its own
acknowledgments.<a href="#section-4.2.3-3" class="pilcrow">¶</a></p>
<p id="section-4.2.3-4">A TCPLS receiver acknowledges the received records using the ACK
frame. Records are acknowledged after the record protection has been
successfully removed. This enables the sender to know which records have been
received. TCPLS enables the endpoint to send acknowledgments for a TCP
connection over any connections, e.g. not only the receiving connection.<a href="#section-4.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="migration">
<section id="section-4.2.4">
          <h4 id="name-migration">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-migration" class="section-name selfRef">Migration</a>
          </h4>
<p id="section-4.2.4-1">To migrate from a given TCP connection, an endpoint stops transmitting
over this TCP connection and sends the following frames on other TCP
connections. It leverages the acknowledgments to retransmit the frames of
TLS records that have not been yet acknowledged.<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
<p id="section-4.2.4-2">When an endpoint abortfully closes a TCP connection, its peer leverages the
acknowlegments to retransmit the TLS records that were not acknowlegded.<a href="#section-4.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multipath">
<section id="section-4.2.5">
          <h4 id="name-multipath">
<a href="#section-4.2.5" class="section-number selfRef">4.2.5. </a><a href="#name-multipath" class="section-name selfRef">Multipath</a>
          </h4>
<p id="section-4.2.5-1">TCPLS also supports the utilization of different TCP connections, over
different paths or interfaces, to improve throughput or spread stream frames
over different TCP connections.
When the endpoints have opened several TCP connections, they can send frames
over the connections. TCPLS can send all the stream frames belonging to a
given stream over one or more underlying TCP connections. The latter enables
bandwidth aggregation by using TCP connections established over different
network paths.<a href="#section-4.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="record-protection">
<section id="section-4.3">
        <h3 id="name-record-protection">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-record-protection" class="section-name selfRef">Record protection</a>
        </h3>
<p id="section-4.3-1">When adding new TCP connections to a TCPLS session, an endpoint does not
complete the TLS handshake. TCPLS provides a nonce construction for TLS
record protection that is used for all connections of a session. This
reduces the cryptographic cost of adding connections. The endpoints <span class="bcp14">SHOULD</span> send
TLS messages to form an apparent complete TLS handshake to middleboxes.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">In order to use the TLS session over multiple connections, TCPLS adds a
record sequence number space per connection that is maintained independently at
both sides. Each record sent over a TCPLS session is identified by the
Connection ID of its connection and its record sequence number. Each record
nonce is constructed as defined in <a href="#fig-record-nonce" class="auto internal xref">Figure 9</a>.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<span id="name-tcpls-tls-record-nonce-cons"></span><div id="fig-record-nonce">
<figure id="figure-9">
          <div class="alignLeft art-text artwork" id="section-4.3-3.1">
<pre>
N                  N-32                   64                    0
+---------------------------------------------------------------+
|                    client/server_write_iv                     |
+---------------------------------------------------------------+
         XOR                                        XOR
+-------------------+                      +--------------------+
|   Connection ID   |                      | Conn. record sequ. |
+-------------------+                      +--------------------+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-tcpls-tls-record-nonce-cons" class="selfRef">TCPLS TLS record nonce construction</a>
          </figcaption></figure>
</div>
<p id="section-4.3-4">This construction guarantees that every TLS record sent over the TLS session
is protected with a unique nonce. As in TLS 1.3, the per-connection record
sequence is implicit.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="closing-a-tcpls-session">
<section id="section-4.4">
        <h3 id="name-closing-a-tcpls-session">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-closing-a-tcpls-session" class="section-name selfRef">Closing a TCPLS session</a>
        </h3>
<p id="section-4.4-1">Endpoints notify their peers that they do not intend to send more data over
a given TCPLS session by sending a TLS Alert "close_notify". The alert can
be sent over one or more TCP connections of the session. The alert <span class="bcp14">MUST</span> be
sent before closing the last TCP connection of the TCPLS session.
The endpoint <span class="bcp14">MAY</span> close its side of the TCP connections after sending the alert.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">When all TCP connections of a session are closed and the TLS Alert
"close_notify" was exchanged in both directions, the TCPLS session is
considered as closed.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">We leave defining an abortful and idle session closure mechanisms for future
versions of this document.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="zero-copy-receive-path">
<section id="section-4.5">
        <h3 id="name-zero-copy-receive-path">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-zero-copy-receive-path" class="section-name selfRef">Zero-Copy Receive Path</a>
        </h3>
<p id="section-4.5-1">TCPLS enables the receiver to process TLS records in a zero-copy manner
under several conditions. When they are met, the application data carried
in TCPLS frames can be decrypted at the right place in the application
buffers.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">First, zero-copy can be achieved when Stream frames of a given stream
arrive in order. When using several TCP connections, out-of-order Stream frames
cannot be processed in zero copy. A Multipath scheduling algorithm
may target the minimization of out-of-order packets.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">Second, the composition
of TCPLS frames in a TLS record is impactful. The sender <span class="bcp14">SHOULD</span> encode a
single Stream Data frame as the first frame of the record, followed by
control-related frames if needed.
When the sender encodes several Stream frames, the frame at the start of
the record <span class="bcp14">SHOULD</span> be the largest, in order to maximise the use of zero copy.
When several Stream frames are included in a record, they <span class="bcp14">SHOULD</span> belong to
different streams.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="format">
<section id="section-5">
      <h2 id="name-tcpls-protocol">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-tcpls-protocol" class="section-name selfRef">TCPLS Protocol</a>
      </h2>
<div id="tcpls-tls-extensions">
<section id="section-5.1">
        <h3 id="name-tcpls-tls-extensions">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-tcpls-tls-extensions" class="section-name selfRef">TCPLS TLS Extensions</a>
        </h3>
<p id="section-5.1-1">This document specifies three TLS extensions used by TCPLS. The first,
"tcpls", is used to announce the support of TCPLS. The second,
"tcpls_join", is used to join a TCP connection to a TCPLS session. The third,
"tcpls_token", is used to provide a token to the client before the handshake
completes. Their types are defined as follows.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-2">
<pre>
enum {
    tcpls(TBD1),
    tcpls_join(TBD2),
    tcpls_token(TBD3),
    (65535)
} ExtensionType;
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1-3">The table below indicates the TLS messages where these extensions can appear.
"CH" indicates ClientHello while "EE" indicates EncryptedExtensions.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<span id="name-tls-messages-allowed-to-car"></span><div id="tcpls-tls-extensions-allowed-tls-messages">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-tls-messages-allowed-to-car" class="selfRef">TLS messages allowed to carry TCPLS TLS Extensions</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Extension</th>
              <th class="text-left" rowspan="1" colspan="1">Allowed TLS messages</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">tcpls</td>
              <td class="text-left" rowspan="1" colspan="1">CH, EE</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">tcpls_join</td>
              <td class="text-left" rowspan="1" colspan="1">CH</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">tcpls_token</td>
              <td class="text-left" rowspan="1" colspan="1">EE</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="tcpls">
<section id="section-5.1.1">
          <h4 id="name-tcpls">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-tcpls" class="section-name selfRef">TCPLS</a>
          </h4>
<p id="section-5.1.1-1">The "tcpls" extension is used by the client and the server to announce
their support of TCPLS. The extension contains no value. When it is present
in both the ClientHello and the EncryptedExtensions, the endpoints <span class="bcp14">MUST</span> use
TCPLS after completing the TLS handshake.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tcpls-join">
<section id="section-5.1.2">
          <h4 id="name-tcpls-join">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-tcpls-join" class="section-name selfRef">TCPLS Join</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.1.2-1">
<pre>
struct {
    opaque token&lt;32&gt;;
} TCPLSJoin;
</pre><a href="#section-5.1.2-1" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-2">The "tcpls_join" extension is used by the client to join the TCP connection
on which it is sent to a TCPLS session. The extension contains a token
provided by the server. The client <span class="bcp14">MUST NOT</span> send more than one
"tcpls_join" extension in its ClientHello. When receiving a ClientHello with
this extension, the server checks that the token is valid and joins the TCP
connection to the corresponding TCPLS session. When the token is not valid,
the server <span class="bcp14">MUST</span> abort the handshake with an illegal_parameter alert.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tcpls-token">
<section id="section-5.1.3">
          <h4 id="name-tcpls-token">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-tcpls-token" class="section-name selfRef">TCPLS Token</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.1.3-1">
<pre>
struct {
    opaque token&lt;32&gt;;
} TCPLSToken;
</pre><a href="#section-5.1.3-1" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3-2">The "tcpls_token" extension is used by the server to provide a token to the
client during the TLS handshake. When receiving this
extension, the client associates the token value as the first token of the TCPLS
session, i.e. with a sequence number of 1. The server <span class="bcp14">MUST NOT</span> send this
extension when the corresponding ClientHello contains
a "tcpls_join" extension.<a href="#section-5.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="tcpls-frames">
<section id="section-5.2">
        <h3 id="name-tcpls-frames">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-tcpls-frames" class="section-name selfRef">TCPLS Frames</a>
        </h3>
<p id="section-5.2-1">TCPLS uses TLS Application Data records to exchange TCPLS frames. After
decryption, the record payload consists of a sequence of TCPLS frames.
<a href="#fig-parsing-tcpls-frames" class="auto internal xref">Figure 10</a> illustrates the manner in which TCPLS frames
are parsed from a decrypted TLS record.
The receiver processes the frames starting from the last one to the first one.
The fields of each frames are also parsed from the end towards the beginning
of the TLS Application Data content. The parsing of a frame starts with the
last byte indicating the frame type and then with type-specific
fields preceeding it, forming a Type-Value unit.
Such ordering enables a zero-copy processing of the type-specific fields as
explained in <a href="#zero-copy-receive-path" class="auto internal xref">Section 4.5</a>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span id="name-parsing-tcpls-frames-inside"></span><div id="fig-parsing-tcpls-frames">
<figure id="figure-10">
          <div class="alignLeft art-text artwork" id="section-5.2-2.1">
<pre>
                       First frame start
                                   |
0         First frame end          | n
+---------------------|------------|-+
|                     v            v |
|      *------------* *------------* |
| .... | Value |Type| | Value |Type| |
|      *------------* *------------* |
+------------------------------------+
        Decrypted TLS record
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-parsing-tcpls-frames-inside" class="selfRef">Parsing TCPLS frames inside a TLS record starts from the end.</a>
          </figcaption></figure>
</div>
<p id="section-5.2-3"><a href="#tcpls-frame-types" class="auto internal xref">Table 2</a> lists the
frames specified in this document.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<span id="name-tcpls-frames-2"></span><div id="tcpls-frame-types">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-tcpls-frames-2" class="selfRef">TCPLS frames</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Type value</th>
              <th class="text-left" rowspan="1" colspan="1">Frame name</th>
              <th class="text-left" rowspan="1" colspan="1">Rules</th>
              <th class="text-left" rowspan="1" colspan="1">Definition</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00</td>
              <td class="text-left" rowspan="1" colspan="1">Padding</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#padding-frame" class="auto internal xref">Section 5.2.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x01</td>
              <td class="text-left" rowspan="1" colspan="1">Ping</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ping-frame" class="auto internal xref">Section 5.2.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x02-0x03</td>
              <td class="text-left" rowspan="1" colspan="1">Stream</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#stream-frame" class="auto internal xref">Section 5.2.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x04</td>
              <td class="text-left" rowspan="1" colspan="1">ACK</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ack-frame" class="auto internal xref">Section 5.2.4</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x05</td>
              <td class="text-left" rowspan="1" colspan="1">New Token</td>
              <td class="text-left" rowspan="1" colspan="1">S</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#new-token-frame" class="auto internal xref">Section 5.2.5</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x06</td>
              <td class="text-left" rowspan="1" colspan="1">Connection Reset</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#connection-reset-frame" class="auto internal xref">Section 5.2.6</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x07</td>
              <td class="text-left" rowspan="1" colspan="1">New Address</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#new-address-frame" class="auto internal xref">Section 5.2.7</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x08</td>
              <td class="text-left" rowspan="1" colspan="1">Remove Address</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#remove-address-frame" class="auto internal xref">Section 5.2.8</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x09</td>
              <td class="text-left" rowspan="1" colspan="1">Stream Change</td>
              <td class="text-left" rowspan="1" colspan="1">Cs</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#stream-change-frame" class="auto internal xref">Section 5.2.9</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-5.2-5">The "Rules" column in <a href="#tcpls-frame-types" class="auto internal xref">Table 2</a> indicates special requirements
regarding certain frames.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-6">
          <dt id="section-5.2-6.1">N:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-6.2">
            <p id="section-5.2-6.2.1">Non-ack-eliciting. Receiving this frame does not elicit the sending of a
TCPLS acknowledgment.<a href="#section-5.2-6.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-6.3">S:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-6.4">
            <p id="section-5.2-6.4.1">Server only. This frame <span class="bcp14">MUST NOT</span> be sent by the client.<a href="#section-5.2-6.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-6.5">Cs:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-6.6">
            <p id="section-5.2-6.6.1">Connection-specific semantics. This frame is not idempotent and has specific
semantics based on the TCP connection over which it is exchanged.<a href="#section-5.2-6.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<div id="padding-frame">
<section id="section-5.2.1">
          <h4 id="name-padding-frame">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-padding-frame" class="section-name selfRef">Padding frame</a>
          </h4>
<p id="section-5.2.1-1">This frame has no semantic value. It can be used to mitigate traffic
analysis on the TLS records of a TCPLS session. The Padding frame has no
content.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<span id="name-padding-frame-format"></span><div id="padding-frame-format">
<figure id="figure-11">
            <div class="alignLeft art-text artwork" id="section-5.2.1-2.1">
<pre>
Padding frame {
    Type (8) = 0x00,
}
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-padding-frame-format" class="selfRef">Padding frame format</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="ping-frame">
<section id="section-5.2.2">
          <h4 id="name-ping-frame">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-ping-frame" class="section-name selfRef">Ping frame</a>
          </h4>
<p id="section-5.2.2-1">This frame is used to elicit an acknowledgment from its peer. It has no
content. When an endpoint receives a Ping frame, it acknowledges the TLS
record that contains this frame. This frame can be used by an endpoint to check
that its peer can receive TLS records over a particular TCP connection.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<span id="name-ping-frame-format"></span><div id="ping-frame-format">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="section-5.2.2-2.1">
<pre>
Ping frame {
    Type (8) = 0x01,
}
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-ping-frame-format" class="selfRef">Ping frame format</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="stream-frame">
<section id="section-5.2.3">
          <h4 id="name-stream-frame">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-stream-frame" class="section-name selfRef">Stream frame</a>
          </h4>
<p id="section-5.2.3-1">This frame is used to carry chunks of data of a given stream.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<span id="name-stream-frame-format"></span><div id="stream-frame-format">
<figure id="figure-13">
            <div class="alignLeft art-text artwork" id="section-5.2.3-2.1">
<pre>
Stream frame {
    Stream Data (...),
    Length (16),
    Offset (64),
    Stream ID (32),
    FIN (1),
    Type (7) = 0x01,
}
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-stream-frame-format" class="selfRef">Stream frame format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.2.3-3">
            <dt id="section-5.2.3-3.1">FIN:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.3-3.2">
              <p id="section-5.2.3-3.2.1">The last bit of the frame type bit indicates that this Stream frame
ends the stream when its value is 1. The last byte of the stream is at the sum of the
Offset and Length fields of this frame.<a href="#section-5.2.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.3-3.3">Stream ID:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.3-3.4">
              <p id="section-5.2.3-3.4.1">A 32-bit unsigned integer indicating the ID of the stream this frame
relates to.<a href="#section-5.2.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.3-3.5">Offset:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.3-3.6">
              <p id="section-5.2.3-3.6.1">A 64-bit unsigned integer indicating the offset in bytes of the carried
data in the stream.<a href="#section-5.2.3-3.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.3-3.7">Length:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.3-3.8">
              <p id="section-5.2.3-3.8.1">A 16-bit unsigned integer indicating the length of the Stream Data field.<a href="#section-5.2.3-3.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ack-frame">
<section id="section-5.2.4">
          <h4 id="name-ack-frame">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-ack-frame" class="section-name selfRef">ACK frame</a>
          </h4>
<p id="section-5.2.4-1">This frame is sent by the receiver to acknowledge the receipt of TLS records on
a particular TCP connection of the TCPLS session. Although the reliability
of the data exchange on a connection is handled by TCP, there are situations
such as the failure of a TCP connection where a sender does not know whether the
TLS frames that it sent have been correctly received by the peer. The ACK frame
allows a TCPLS receiver to indicate the highest TLS record sequence number
received on a specific connection. The ACK frame can be sent over any TCP
connection of a TCPLS session.<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<span id="name-ack-frame-format"></span><div id="ack-frame-format">
<figure id="figure-14">
            <div class="alignLeft art-text artwork" id="section-5.2.4-2.1">
<pre>
ACK frame {
    Highest Record Sequence Received (64),
    Connection ID (32),
    Type (8) = 0x04,
}
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-ack-frame-format" class="selfRef">ACK frame format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.2.4-3">
            <dt id="section-5.2.4-3.1">Connection ID:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.4-3.2">
              <p id="section-5.2.4-3.2.1">A 32-bit unsigned integer indicating the TCP connection for which the
acknowledgment was sent.<a href="#section-5.2.4-3.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.4-3.3">Highest Record Sequence Received:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.4-3.4">
              <p id="section-5.2.4-3.4.1">A 64-bit unsigned integer indicating the highest TLS record sequence
number received on the connection indicated by the Connection ID.<a href="#section-5.2.4-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="new-token-frame">
<section id="section-5.2.5">
          <h4 id="name-new-token-frame">
<a href="#section-5.2.5" class="section-number selfRef">5.2.5. </a><a href="#name-new-token-frame" class="section-name selfRef">New Token frame</a>
          </h4>
<p id="section-5.2.5-1">This frame is used by the server to provide tokens to the client. Each token
can be used to join a new TCP connection to the TCPLS session, as described
in <a href="#joining-tcp-connections" class="auto internal xref">Section 4.2.1</a>. Clients <span class="bcp14">MUST NOT</span> send New Token frames.<a href="#section-5.2.5-1" class="pilcrow">¶</a></p>
<span id="name-new-token-frame-format"></span><div id="new-token-frame-format">
<figure id="figure-15">
            <div class="alignLeft art-text artwork" id="section-5.2.5-2.1">
<pre>
New Token frame {
    Token (256),
    Sequence (8),
    Type (8) = 0x05,
}
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-new-token-frame-format" class="selfRef">New Token frame format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.2.5-3">
            <dt id="section-5.2.5-3.1">Sequence:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.5-3.2">
              <p id="section-5.2.5-3.2.1">A 8-bit unsigned integer indicating the sequence number of this token<a href="#section-5.2.5-3.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.5-3.3">Token:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.5-3.4">
              <p id="section-5.2.5-3.4.1">A 32-byte opaque value that can be used as a token by the client.<a href="#section-5.2.5-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.2.5-4">By controlling the amount of tokens given to the client, the server can
control the number of active TCP connections of a TCPLS session. The server <span class="bcp14">SHOULD</span>
replenish the tokens when TCP connections are removed from the TCPLS session.<a href="#section-5.2.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="connection-reset-frame">
<section id="section-5.2.6">
          <h4 id="name-connection-reset-frame">
<a href="#section-5.2.6" class="section-number selfRef">5.2.6. </a><a href="#name-connection-reset-frame" class="section-name selfRef">Connection Reset frame</a>
          </h4>
<p id="section-5.2.6-1">This frame is used by the receiver to inform the sender that a TCP
connection has been reset.<a href="#section-5.2.6-1" class="pilcrow">¶</a></p>
<span id="name-connection-reset-format"></span><div id="connection-reset-format">
<figure id="figure-16">
            <div class="alignLeft art-text artwork" id="section-5.2.6-2.1">
<pre>
Connection Reset frame {
    Connection ID (32)
    Type (8) = 0x06,
}
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-connection-reset-format" class="selfRef">Connection Reset format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.2.6-3">
            <dt id="section-5.2.6-3.1">Connection ID:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.6-3.2">
              <p id="section-5.2.6-3.2.1">A 32-bit unsigned integer indicating the ID of the connection that failed.<a href="#section-5.2.6-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="new-address-frame">
<section id="section-5.2.7">
          <h4 id="name-new-address-frame">
<a href="#section-5.2.7" class="section-number selfRef">5.2.7. </a><a href="#name-new-address-frame" class="section-name selfRef">New Address frame</a>
          </h4>
<p id="section-5.2.7-1">This frame is used by an endpoint to add a new local address to the TCPLS
session. This address can then be used to establish new TCP connections.
The server advertises addresses that the client can use as destination when
adding TCP connections. The client advertises address that it can use as source
when adding TCP connections.<a href="#section-5.2.7-1" class="pilcrow">¶</a></p>
<span id="name-new-address-format"></span><div id="new-address-format">
<figure id="figure-17">
            <div class="alignLeft art-text artwork" id="section-5.2.7-2.1">
<pre>
New Address frame {
    Port (16),
    Address (..),
    Address Version (8),
    Address ID (8),
    Type (8) = 0x07,
}
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-new-address-format" class="selfRef">New Address format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.2.7-3">
            <dt id="section-5.2.7-3.1">Address ID:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.7-3.2">
              <p id="section-5.2.7-3.2.1">A 8-bit identifier for this address. For a given Address ID, an endpoint
receiving a frame with a content that differs from previously received frames
<span class="bcp14">MUST</span> ignore the frame. An endpoint receiving a frame for an Address ID that was
previously removed <span class="bcp14">MUST</span> ignore the frame.<a href="#section-5.2.7-3.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.7-3.3">Address Version:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.7-3.4">
              <p id="section-5.2.7-3.4.1">A 8-bit value identifying the Internet address version of this address. The
number 4 indicates IPv4 while 6 indicates IPv6.<a href="#section-5.2.7-3.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.7-3.5">Address:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.7-3.6">
              <p id="section-5.2.7-3.6.1">The address value. Its size depends on its version. IPv4 addresses are 32-bit
long while IPv6 addresses are 128-bit long.<a href="#section-5.2.7-3.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.7-3.7">Port:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.7-3.8">
              <p id="section-5.2.7-3.8.1">A 16-bit value indicating the TCP port used with this address.<a href="#section-5.2.7-3.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="remove-address-frame">
<section id="section-5.2.8">
          <h4 id="name-remove-address-frame">
<a href="#section-5.2.8" class="section-number selfRef">5.2.8. </a><a href="#name-remove-address-frame" class="section-name selfRef">Remove Address frame</a>
          </h4>
<p id="section-5.2.8-1">This frame is used by an endpoint to announce that it is not willing to use a
given address to establish new TCP connections. After receiving this frame, a
client <span class="bcp14">MUST NOT</span> establish new TCP connections to the given address. After
receiving this frame, an endpoint <span class="bcp14">MUST</span> close all TCP connections using the
given address.<a href="#section-5.2.8-1" class="pilcrow">¶</a></p>
<span id="name-remove-address-format"></span><div id="remove-address-format">
<figure id="figure-18">
            <div class="alignLeft art-text artwork" id="section-5.2.8-2.1">
<pre>
Remove Address frame {
    Address ID (8),
    Type (8) = 0x08,
}
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-remove-address-format" class="selfRef">Remove Address format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.2.8-3">
            <dt id="section-5.2.8-3.1">Address ID:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.8-3.2">
              <p id="section-5.2.8-3.2.1">A 8-bit identifier for the address to remove. An endpoint receiving a frame
for an address that was nonexistent or already removed <span class="bcp14">MUST</span> ignore the frame.<a href="#section-5.2.8-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="stream-change-frame">
<section id="section-5.2.9">
          <h4 id="name-stream-change-frame">
<a href="#section-5.2.9" class="section-number selfRef">5.2.9. </a><a href="#name-stream-change-frame" class="section-name selfRef">Stream Change frame</a>
          </h4>
<p id="section-5.2.9-1">This frame is used by a sender to announce the Stream ID and Offset
of the next record over a given TCP connection. It can be used to make
explicit a change in stream scheduling over a connection to the receiver,
enabling a zero-copy receive path as explained in <a href="#zero-copy-receive-path" class="auto internal xref">Section 4.5</a>.
The hint contained in this frame relates to the connection over which it
was exchanged.<a href="#section-5.2.9-1" class="pilcrow">¶</a></p>
<span id="name-stream-change-format"></span><div id="stream-change-format">
<figure id="figure-19">
            <div class="alignLeft art-text artwork" id="section-5.2.9-2.1">
<pre>
Stream Change frame {
    Next Record Stream ID (32),
    Next Offset (64),
    Type (8) = 0x09,
}
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-stream-change-format" class="selfRef">Stream Change format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.2.9-3">
            <dt id="section-5.2.9-3.1">Next Record Stream ID:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.9-3.2">
              <p id="section-5.2.9-3.2.1">A 32-bit unsigned integer indicating the Stream ID of the Stream frame in the
next record .<a href="#section-5.2.9-3.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.9-3.3">Next Offset:</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.9-3.4">
              <p id="section-5.2.9-3.4.1">A 64-bit unsigned integer indicating the Offset of the Stream frame in the
next record.<a href="#section-5.2.9-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">When issuing tokens to the client as presented in <a href="#joining-tcp-connections" class="auto internal xref">Section 4.2.1</a>,
the server <span class="bcp14">SHOULD</span> ensure that their values appear as random to observers and
cannot be correlated together for a given TCPLS session.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The security considerations for TLS apply to TCPLS.
The next versions of this document will elaborate on other security
considerations following the guidelines of <span>[<a href="#RFC3552" class="cite xref">RFC3552</a>]</span>.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">IANA is requested to create a new "TCPLS" heading for the new registry
described in <a href="#tcpls-frames" class="auto internal xref">Section 5.2</a>. New registrations in TCPLS registries follow
the "Specification Required" policy of <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="tcpls-tls-extensions-1">
<section id="section-7.1">
        <h3 id="name-tcpls-tls-extensions-2">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-tcpls-tls-extensions-2" class="section-name selfRef">TCPLS TLS Extensions</a>
        </h3>
<p id="section-7.1-1">IANA is requested to add the following entries to the existing "TLS
ExtensionType Values" registry.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Extension Name</th>
              <th class="text-left" rowspan="1" colspan="1">TLS 1.3</th>
              <th class="text-left" rowspan="1" colspan="1">Recommended</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD1</td>
              <td class="text-left" rowspan="1" colspan="1">tcpls</td>
              <td class="text-left" rowspan="1" colspan="1">CH, EE</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD2</td>
              <td class="text-left" rowspan="1" colspan="1">tcpls_join</td>
              <td class="text-left" rowspan="1" colspan="1">CH</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD3</td>
              <td class="text-left" rowspan="1" colspan="1">tcpls_token</td>
              <td class="text-left" rowspan="1" colspan="1">EE</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
<p id="section-7.1-3">Note that "Recommended" is set to N as these extensions are intended for
uses as described in this document.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tcpls-frames-1">
<section id="section-7.2">
        <h3 id="name-tcpls-frames-3">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-tcpls-frames-3" class="section-name selfRef">TCPLS Frames</a>
        </h3>
<p id="section-7.2-1">IANA is requested to create a new registry "TCPLS Frames Types" under the
"TCPLS" heading.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">The registry governs an 8-bit space. Entries in this registry must include a
"Frame name" field containing a short mnemonic for the frame type. The
initial content of the registry is present in <a href="#tcpls-frame-types" class="auto internal xref">Table 2</a>, without
the "Rules" column.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CONEXT21">[CONEXT21]</dt>
        <dd>
<span class="refAuthor">Rochet, F.</span>, <span class="refAuthor">Assogba, E.</span>, <span class="refAuthor">Piraux, M.</span>, <span class="refAuthor">Edeline, K.</span>, <span class="refAuthor">Donnet, B.</span>, and <span class="refAuthor">O. Bonaventure</span>, <span class="refTitle">"TCPLS - Modern Transport Services with TCP and TLS"</span>, <span class="seriesInfo">Proceedings of the 17th International Conference on emerging Networking EXperiments and Technologies (CoNEXT'21) </span>, <time datetime="2021-12" class="refDate">December 2021</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-dtls13">[I-D.ietf-tls-dtls13]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls13-43</span>, <time datetime="2021-04-30" class="refDate">30 April 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-dtls13-43">https://datatracker.ietf.org/doc/html/draft-ietf-tls-dtls13-43</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3552">[RFC3552]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">B. Korver</span>, <span class="refTitle">"Guidelines for Writing RFC Text on Security Considerations"</span>, <span class="seriesInfo">BCP 72</span>, <span class="seriesInfo">RFC 3552</span>, <span class="seriesInfo">DOI 10.17487/RFC3552</span>, <time datetime="2003-07" class="refDate">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3552">https://www.rfc-editor.org/rfc/rfc3552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4960">[RFC4960]</dt>
        <dd>
<span class="refAuthor">Stewart, R., Ed.</span>, <span class="refTitle">"Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 4960</span>, <span class="seriesInfo">DOI 10.17487/RFC4960</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4960">https://www.rfc-editor.org/rfc/rfc4960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6335">[RFC6335]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Westerlund, M.</span>, and <span class="refAuthor">S. Cheshire</span>, <span class="refTitle">"Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry"</span>, <span class="seriesInfo">BCP 165</span>, <span class="seriesInfo">RFC 6335</span>, <span class="seriesInfo">DOI 10.17487/RFC6335</span>, <time datetime="2011-08" class="refDate">August 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6335">https://www.rfc-editor.org/rfc/rfc6335</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7258">https://www.rfc-editor.org/rfc/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7540">[RFC7540]</dt>
        <dd>
<span class="refAuthor">Belshe, M.</span>, <span class="refAuthor">Peon, R.</span>, and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7540">https://www.rfc-editor.org/rfc/rfc7540</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8041">[RFC8041]</dt>
        <dd>
<span class="refAuthor">Bonaventure, O.</span>, <span class="refAuthor">Paasch, C.</span>, and <span class="refAuthor">G. Detal</span>, <span class="refTitle">"Use Cases and Operational Experience with Multipath TCP"</span>, <span class="seriesInfo">RFC 8041</span>, <span class="seriesInfo">DOI 10.17487/RFC8041</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8041">https://www.rfc-editor.org/rfc/rfc8041</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8305">[RFC8305]</dt>
        <dd>
<span class="refAuthor">Schinazi, D.</span> and <span class="refAuthor">T. Pauly</span>, <span class="refTitle">"Happy Eyeballs Version 2: Better Connectivity Using Concurrency"</span>, <span class="seriesInfo">RFC 8305</span>, <span class="seriesInfo">DOI 10.17487/RFC8305</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8305">https://www.rfc-editor.org/rfc/rfc8305</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8548">[RFC8548]</dt>
        <dd>
<span class="refAuthor">Bittau, A.</span>, <span class="refAuthor">Giffin, D.</span>, <span class="refAuthor">Handley, M.</span>, <span class="refAuthor">Mazieres, D.</span>, <span class="refAuthor">Slack, Q.</span>, and <span class="refAuthor">E. Smith</span>, <span class="refTitle">"Cryptographic Protection of TCP Streams (tcpcrypt)"</span>, <span class="seriesInfo">RFC 8548</span>, <span class="seriesInfo">DOI 10.17487/RFC8548</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8548">https://www.rfc-editor.org/rfc/rfc8548</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8684">[RFC8684]</dt>
        <dd>
<span class="refAuthor">Ford, A.</span>, <span class="refAuthor">Raiciu, C.</span>, <span class="refAuthor">Handley, M.</span>, <span class="refAuthor">Bonaventure, O.</span>, and <span class="refAuthor">C. Paasch</span>, <span class="refTitle">"TCP Extensions for Multipath Operation with Multiple Addresses"</span>, <span class="seriesInfo">RFC 8684</span>, <span class="seriesInfo">DOI 10.17487/RFC8684</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8684">https://www.rfc-editor.org/rfc/rfc8684</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
      <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="alternative-designs">
<section id="appendix-A">
      <h2 id="name-alternative-designs">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-alternative-designs" class="section-name selfRef">Alternative Designs</a>
      </h2>
<p id="appendix-A-1">In this section, we discuss alternatives to mechanisms defined in this document.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="securing-new-tcp-connections-with-new-session-tickets">
<section id="appendix-A.1">
        <h3 id="name-securing-new-tcp-connection">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-securing-new-tcp-connection" class="section-name selfRef">Securing new TCP connections with New Session Tickets</a>
        </h3>
<p id="appendix-A.1-1">When adding a new TCP connection to a TCPLS session, endpoints derive a
Initial Vector based on the technique presented in <a href="#record-protection" class="auto internal xref">Section 4.3</a>.
An alternative is to use New Session Tickets to derive separate
cryptographic protection materials based on a pre-shared key sent by the
server. In this mode of operation, the server provides New Session Tickets
to control the amount of additional TCP connections that can be opened by
the client. The server could encode the Connection ID in the ticket value.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">Using this mechanism differs from our proposal in several ways. While it
enables to use an existing TLS mechanism for this purpose, it has a number
of differences. First, it requires the server to compute pre-shared keys
which could be more costly than computing the TCPLS tokens defined in
<a href="#joining-tcp-connections" class="auto internal xref">Section 4.2.1</a>. Second, when used to establish a TLS session,
additional TLS messages must be computed and exchanged to complete the
handshake, which the current mechanism does not require.
Third, TLS New Session Tickets have a lifetime that is separated from the
session they are exchanged over. This is unneeded in the context of TCPLS
and may require additional protocol specification and guidance to
implementers.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">This work has been partially supported by the ``Programme de
recherche d'interet général WALINNOV - MQUIC project (convention number
1810018)'' and European Union through the NGI Pointer programme for the TCPLS
project (Horizon 2020 Framework Programme, Grant agreement number 871528).
The authors thank Quentin De Coninck and Louis Navarre for their
comments on the first version of this draft.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="change-log">
<section id="appendix-C">
      <h2 id="name-change-log">
<a href="#name-change-log" class="section-name selfRef">Change log</a>
      </h2>
<div id="since-draft-piraux-tcpls-02">
<section id="appendix-C.1">
        <h3 id="name-since-draft-piraux-tcpls-02">
<a href="#name-since-draft-piraux-tcpls-02" class="section-name selfRef">Since draft-piraux-tcpls-02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.1-1.1">Adds the TCPLS Token TLS extension to enable fast robust session
establishment.<a href="#appendix-C.1-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="since-draft-piraux-tcpls-01">
<section id="appendix-C.2">
        <h3 id="name-since-draft-piraux-tcpls-01">
<a href="#name-since-draft-piraux-tcpls-01" class="section-name selfRef">Since draft-piraux-tcpls-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.2-1.1">Change frames and fields order to enable zero-copy receiver.<a href="#appendix-C.2-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="since-draft-piraux-tcpls-00">
<section id="appendix-C.3">
        <h3 id="name-since-draft-piraux-tcpls-00">
<a href="#name-since-draft-piraux-tcpls-00" class="section-name selfRef">Since draft-piraux-tcpls-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.3-1.1">Added the addresses exchange mechanism with New Address and Remove Address
frames.<a href="#appendix-C.3-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Maxime Piraux</span></div>
<div dir="auto" class="left"><span class="org">UCLouvain</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:maxime.piraux@uclouvain.be" class="email">maxime.piraux@uclouvain.be</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Florentin Rochet</span></div>
<div dir="auto" class="left"><span class="org">University of Namur</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:florentin.rochet@unamur.be" class="email">florentin.rochet@unamur.be</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Olivier Bonaventure</span></div>
<div dir="auto" class="left"><span class="org">UCLouvain</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:olivier.bonaventure@uclouvain.be" class="email">olivier.bonaventure@uclouvain.be</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
